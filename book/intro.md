---
jupytext:
  cell_metadata_filter: -all
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.12
    jupytext_version: 1.8.0
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

Introduction  
============
Brain parcellation can be viewed and understood as a tool for compressing functional MRI data. The main objective is to reduce the dimensionality of brain functional organization with a high fidelity. Functional brain parcellations are very useful and intensively applied in the neuroscience field, and specifically network neuroscience. For instance, different studies reported better accuracy in the prediction of mental states, neurological disorders, etc., depending on the choice of a brain parcellation [Dadi et al. 2020, Fornito et al. 2016]. Traditional static brain parcellations subdivided the cerebral cortex into a single fixed parcellation composed of “hard” binary assignment of voxels to a given parcel with well-defined boundaries [Eichkoff et al. 2018]. Even though there existed several static functional approaches in the literature, there was no consensus on which approach better reduce the high dimensionality of the functional data [Cite surveys Arslan et al. 2017]. That is, the compression rate of static parcellations seem to reflect primarily the size of parcels (resolution), and state-of-the-art algorithms offer little to no advantage compared to random brain parcellation (see Fig 7 of Urchs et al. 2019). Additionally, the evaluation of the goodness of functional parcellations was evaluated using reproducibility on test-retest datasets. However, these reproducibility scores did not reach high scores at the individual level and it plateaued at 0.7 dice score even in the context of over 30 minutes of resting state data [Gordon et al. 2017]. Researchers associated this mainly, to within-subject or between-subjects fMRI variability [Braga & Buckner, 2017; Nastase et al., n.d.; Sripada et al., 2019]. For instance, a recent study investigated the variability in spatial functional boundaries of regions associated with different human adults' lifespan (20-93). Here, the authors explained the differences in parcellation boundaries by differences in cortical thickness and anatomical alignment due to age differences [Han et al. 2018].  

Another research direction formalized the parcellation problem as a space-time decomposition using soft and dynamic parcellations. Soft parcellation meant that a given voxel was attributed a weight of appartenance to a given parcel, e.g. a probability score REF. Dynamic parcellation meant that different parcels could overlap, and the strength of expression of a given parcel may vary over time. An important difference between static and dynamic parcellations was how fMRI data were compressed in parcels. In the case of a static parcellation, the compression was univariate. Each parcel represented the average functional activity at a specific spatial location in the cerebral cortex. An average signal was generated for each parcel, or a principal component analysis was applied to the signal inside the parcel [Eickhoff et al., 2018]. In the case of dynamic parcellations, the compression was multivariate as the parcels (or spatial modes of decomposition) were used altogether using a multivariate regression analysis to fit a full brain activity volumes over time [V. D. Calhoun et al., 2001] resulting in spatially overlapping parcels, i.e., the same voxel was involved with different states. This approach was applied by the Independent component analysis ICA for more than a decade. Recently, some researchers showed the application of a dynamic approach improved the fidelity of the compressed data to the actual neurobiological changes over time in space. For instance, Dadi and colleagues used the spatial sparsity constraint to generate dynamic brain parcels [Dadi et al. 2020]. Authors showed the compression of activation maps was improved using soft and dynamic parcellations over a range of classic static parcellations [Dadi et al. 2020]. Here, authors showed the existence of variability in temporal features that were not confounded with spatial features [Harrison et al,  2020]. Despite the existence of different attempts to apply the space-time decomposition of fMRI data, there are still two main limitations of previous approaches. First, the lack of scalability to the high dimensionality of functional MRI data (e.g., ICA approach). This motivated the introduction of PROFUMO, a matrix factorisation model that identified subject-specific spatial maps using a variational Bayesian approach with spatiotemporal priors instead of ICA dual regression (Harrison et al., 2015, CITE). Other previous approaches required terabytes of functional data to converge to good quality solutions [Dadi et al. 2020]. That could be problematic, especially in the case of the clinical datasets; e.g. Alzheimer disease datasets [REF]. Our previous seed-based implementation of DYPAC 1.0 was based on a simple and scalable cluster aggregation. This motivated us to see if it could be extended to a scalable full brain analysis. We also wanted to see if we can reduce the information loss between the original and the reduced functional data using full brain state stability maps.   

The main finding of DYPAC 1.0 was the existence of high spatial reproducibility at the within-subject level (between test-retest datasets) in short time series (~ 3 minutes) and using a very basic clustering algorithm. Across states, there existed different spatial reconfigurations within the same subject, especially in the cases of the dACC and PCC seed subnetworks. That is, there were some differences locally, at the level of a region surrounding the seed subnetwork for some states. There were also differences in spatial states involving multiple regions distributed throughout the brain. Similar local and distributed variations were observed with the PCC seed subnetwork, which had up to three states. In the literature, there existed a spatial overlapping pattern between space-time decompositions generated by the ICA and the DYPAC1.0 approach even though the underlying formalism was different. That spatial overlap was identified in the case of the visual network, the default mode network, the MPFC regions and regions of the dorsal attentional subnetwork [Boukhdhir et al., 2020, Beckmann et al., 2005; Damoiseaux et al., 2006; Zuo et al., 2010]. 

In this paper, we build upon the findings of Boukhdhir and colleagues and we extend the dynamic parcellation approach to extract full brain dynamic states of functional parcellations at the individual level [Boukhdhir et al. 2020]. We define a dynamic state of parcellation as the time-space decomposition that occurs for short time durations in the resting state condition. This approach is based on aggregating sliding-window parcellations for a given region to obtain stability maps of the different dynamic states of parcellations. We generate these dynamic states for the six subjects of the Courtois Neuromod dataset and we aim to evaluate the compression quality of the state stability maps at the full brain level. We also aim to study similarities and variations within-subject (between sets of independent data for the same subject) and across subjects.   


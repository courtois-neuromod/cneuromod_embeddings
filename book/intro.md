---
jupytext:
  cell_metadata_filter: -all
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.12
    jupytext_version: 1.8.0
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Introduction  

## Main objective
Brain parcels are ubiquitous in network neuroscience, as parcels play the role of nodes in graph models of brain networks {cite}`Bullmore2009-dh`. Recently, a series of studies have aimed to characterize these parcels at the individual level using so-called "deep phenotyping" functional magnetic resonance (fMRI) datasets, with long fMRI time series (several hours) acquired on a limited number of subjects {cite}`Poldrack2021-yp`. Gordon and colleagues (2017) notably showed reliable subject-specific variants in brain parcels at rest in the Midnight Brain Scan dataset {cite}`Gordon2017-gd`. Salehi and colleagues (2020) demonstrated that fMRI brain parcels varied systematically across tasks, even for a given individual {cite}`Salehi2020-bh`. Our group (Boukhdir et al., 2020) then showed that dynamic states of brain parcellations could be identified at rest using short sliding windows, by focusing on a series of seed regions in the brain in the Midnight Brain Scan dataset {cite}`Boukhdhir2020`. It is not clear whether the task-specific parcels of Salehi and colleagues match the dynamic parcels at rest identified by Boukhdhir and colleagues. In this paper, our main objective is to extend the analytical framework of Boukhdhir and colleagues to the full brain, and assess whether dynamic parcels generalize across a variety of cognitive contexts, including resting-state, different types of movies as well as controlled cognitive tasks. This is implemented using the first data release of the Courtois project on neuronal modelling (CNeuroMod 2020-beta, ~40 hours of fMRI data per subject, N=6) [REF].

## Dynamic brain parcellation
Traditional functional brain parcellations are "hard" assignments, i.e. each brain voxel belongs to one and only one parcel with well-defined boundaries. Hard brain parcellations in fMRI emerged in the late 90s and early 2000s, generated through cluster analysis {cite}`Goutte1999-zb,Salvador2005-cl`, and some hard functional brain parcellations are still being developed to this date, e.g. {cite}`Craddock2012-ln,Yeo2011-fd,Schaefer2018-ww`. Hard parcellations are static in nature: parcels are identical for each time point. Alternatively, many functional brain parcellations use "soft" parcel assignments, where each voxel is attributed a weight of membership to a given parcel. Soft parcellations are dynamic in nature, as soft parcels can overlap and the strength of expression of a given parcel may vary over time. Soft parcellations became popular in the years 2000 with the application of Independent component analysis (ICA) to fMRI {cite}`Calhoun2001-kd,Damoiseaux2006-od,Smith2009-pt`, with modern variants aimed to better characterize inter-individual variations and scale better to large datasets {cite}`Harrison2020-jk,Dadi2020-gb,Du2020-tm`. Our recent work {cite}`Boukhdhir2020` draws a bridge between hard and soft parcellations. We generated hard parcels over short sliding windows with a very basic clustering algorithm (k-means), and then grouped similar parcels over time into "states" using a second temporal cluster analysis. Dynamic parcels are then defined as average hard parcels within each state. We found those dynamic parcels to be highly reproducible and subject-specific. However, the technique used in {cite}`Boukhdhir2020` was limited to specific seed voxels in the brain, and one of the objective of this work is to extend the algorithm to the full brain using a scalable approach.

## Reproducibility of individual brain parcels
Additionally, the evaluation of the goodness of functional parcellations was evaluated using reproducibility on test-retest datasets. However, these reproducibility scores did not reach high scores at the individual level and it plateaued at 0.7 dice score even in the context of over 30 minutes of resting state data [Gordon et al. 2017]. Researchers associated this mainly, to within-subject or between-subjects fMRI variability [Braga & Buckner, 2017; Nastase et al., n.d.; Sripada et al., 2019]. For instance, a recent study investigated the variability in spatial functional boundaries of regions associated with different human adults' lifespan (20-93). Here, the authors explained the differences in parcellation boundaries by differences in cortical thickness and anatomical alignment due to age differences [Han et al. 2018].  

## Homogeneity of individual brain parcels
An important difference between static and dynamic parcellations was how fMRI data were compressed in parcels. In the case of a static parcellation, the compression was univariate. Each parcel represented the average functional activity at a specific spatial location in the cerebral cortex. An average signal was generated for each parcel, or a principal component analysis was applied to the signal inside the parcel [Eickhoff et al., 2018]. In the case of dynamic parcellations, the compression was multivariate as the parcels (or spatial modes of decomposition) were used altogether using a multivariate regression analysis to fit a full brain activity volumes over time {cite}`Calhoun2001-kd` resulting in spatially overlapping parcels, i.e., the same voxel was involved with different states. Recently, some researchers showed the application of a dynamic approach improved the fidelity of the compressed data to the actual neurobiological changes over time in space. For instance, Dadi and colleagues used the spatial sparsity constraint to generate dynamic brain parcels [Dadi et al. 2020]. Authors showed the compression of activation maps was improved using soft and dynamic parcellations over a range of classic static parcellations [Dadi et al. 2020]. Here, authors showed the existence of variability in temporal features that were not confounded with spatial features [Harrison et al,  2020]. Even though there existed several static functional approaches in the literature, there was no consensus on which approach better reduce the high dimensionality of the functional data [Cite surveys Arslan et al. 2017]. That is, the compression rate of static parcellations seem to reflect primarily the size of parcels (resolution), and state-of-the-art algorithms offer little to no advantage compared to random brain parcellation (see Fig 7 of Urchs et al. 2019).

## Specific objectives
In this paper, we build upon the findings of Boukhdhir and colleagues and we extend the dynamic parcellation approach to extract full brain dynamic states of functional parcellations at the individual level [Boukhdhir et al. 2020]. We define a dynamic state of parcellation as the time-space decomposition that occurs for short time durations in the resting state condition. This approach is based on aggregating sliding-window parcellations for a given region to obtain stability maps of the different dynamic states of parcellations. We generate these dynamic states for the six subjects of the Courtois Neuromod dataset and we aim to evaluate the compression quality of the state stability maps at the full brain level. We also aim to study similarities and variations within-subject (between sets of independent data for the same subject) and across subjects.   

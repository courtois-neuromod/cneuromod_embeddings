
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>R2 in the cortex &#8212; cneuromod-embeddings</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Discussion" href="discussion.html" />
    <link rel="prev" title="Test-retest reproducibility" href="friends-s01_reproducibility.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">cneuromod-embeddings</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="abstract.html">
   Abstract
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="methods.html">
   Methods
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="results.html">
   Results
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active collapsible-parent">
    <a class="reference internal" href="friends-s01_overview.html">
     friends-s01
    </a>
    <ul class="current collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="friends-s01_reproducibility.html">
       Test-retest reproducibility
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       R2 in the cortex
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="discussion.html">
   Discussion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="conclusion.html">
   Conclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="acknowledgments.html">
   Acknowledgments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="supplementary.html">
   Supplementary material
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2 collapsible-parent">
    <a class="reference internal" href="supplementary_friends-s01.html">
     Supplementary friends-s01
    </a>
    <ul class="collapse-ul">
     <li class="toctree-l3">
      <a class="reference internal" href="friends-s01_match_state-60.html">
       Parcel matching (state=60)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="friends-s01_match_state-900.html">
       Parcel matching (
       <code class="docutils literal notranslate">
        <span class="pre">
         state=900
        </span>
       </code>
       )
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="friends-s01_r2_maps.html">
       R2 maps
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="friends-s01_r2_central.html">
       R2 in central structures
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="friends-s01_r2_cerebellum.html">
       R2 in the cerebellum
      </a>
     </li>
    </ul>
    <i class="fas fa-chevron-down">
    </i>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/friends-s01_r2_cortex.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/friends-s01_r2_cortex.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/courtois-neuromod/cneuromod_embeddings"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/courtois-neuromod/cneuromod_embeddings/issues/new?title=Issue%20on%20page%20%2Ffriends-s01_r2_cortex.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/courtois-neuromod/cneuromod_embeddings/main?urlpath=tree/friends-s01_r2_cortex.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r2-with-fwhm-5">
   R2 with
   <code class="docutils literal notranslate">
    <span class="pre">
     fwhm=5
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dypac-intra-vs-difumo">
     DYPAC intra vs DIFUMO
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dypac-intra-vs-other-group-parcellations">
     DYPAC intra vs other group parcellations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#dypac-multi-resolution">
     DYPAC multi-resolution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#intra-vs-inter-subject-r2">
     Intra- vs inter-subject R2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#r2-with-fwhm-8">
   R2 with
   <code class="docutils literal notranslate">
    <span class="pre">
     fwhm=8
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     DYPAC intra vs DIFUMO
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     DYPAC intra vs other group parcellations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mist-multi-resolution">
     MIST multi resolution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Intra vs inter subject R2
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="r2-in-the-cortex">
<span id="friends-s01-r2-cortex"></span><h1>R2 in the cortex<a class="headerlink" href="#r2-in-the-cortex" title="Permalink to this headline">¶</a></h1>
<p>We examined next the fidelity of embedding fMRI time series in parcellation space, using time series from the validation subset of <code class="docutils literal notranslate"><span class="pre">friends-s01</span></code> and parcellations generated in the training subset, either from the same subject (intra-subject R2), or from a different subject (inter-subject R2). We also generated R2 maps using public group parcellations. As a preliminary analysis, we visualized <a class="reference internal" href="friends-s01_r2_maps.html#friends-s01-r2-maps"><span class="std std-ref">R2 maps</span></a> averaged across all runs, and noticed that central structures (thalami, basal ganglia) and the cerebellum had markedly lower R2 values (see Supplementary Material). We thus decided to consider the distribution of R2 only in the cortex for the selection of hyper-parameters, which is presented here. The distribution of <a class="reference internal" href="friends-s01_r2_central.html#friends-s01-r2-central"><span class="std std-ref">R2 in central structures</span></a> and <a class="reference internal" href="friends-s01_r2_cerebellum.html#friends-s01-r2-cerebellum"><span class="std std-ref">R2 in the cerebellum</span></a> are available in Supplementary Material.</p>
<div class="admonition-computational-reproducibility admonition">
<p class="admonition-title">Computational reproducibility</p>
<p>The results for this experiment have been precomputed usin the scripts <code class="docutils literal notranslate"><span class="pre">r2_summary.py</span></code> and <code class="docutils literal notranslate"><span class="pre">r2_friends-s01.sh</span></code>. The results are accessed using a number of helper tools available in the <code class="docutils literal notranslate"><span class="pre">r2_summary</span></code> module. The following hidden block of code loads the necessary libraries to generate the figures, sets the path to find the pre-comupted results as well as some visualisation parameters.</p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries </span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">cneuromod_embeddings.r2_summary</span> <span class="kn">import</span> <span class="n">_r2_intra</span><span class="p">,</span> <span class="n">_r2_inter</span><span class="p">,</span> <span class="n">_r2_other</span>

<span class="c1"># Set the Seaborn parameters</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="c1"># Set up file names... where to find the data.</span>
<span class="n">path_data</span> <span class="o">=</span> <span class="s1">&#39;/home/pbellec/git/cneuromod_embeddings/cneuromod_embeddings/friends-s01/&#39;</span>
<span class="n">path_results</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_data</span><span class="p">,</span> <span class="s1">&#39;r2_friends-s01_cortex&#39;</span><span class="p">)</span>

<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># DYPAC</span>
<span class="n">dypac60</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-60.p&#39;</span><span class="p">)</span>
<span class="n">dypac120</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-120.p&#39;</span><span class="p">)</span>
<span class="n">dypac150</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-150.p&#39;</span><span class="p">)</span>
<span class="n">dypac300</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-300.p&#39;</span><span class="p">)</span>
<span class="n">dypac900</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-300_state-900.p&#39;</span><span class="p">)</span>

<span class="c1"># DYPAC inter-subject</span>
<span class="n">inter60</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-60.p&#39;</span><span class="p">)</span>
<span class="n">inter120</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-120.p&#39;</span><span class="p">)</span>
<span class="n">inter150</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-150.p&#39;</span><span class="p">)</span>
<span class="n">inter300</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-300.p&#39;</span><span class="p">)</span>
<span class="n">inter900</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-300_state-900.p&#39;</span><span class="p">)</span>

<span class="c1"># DIFUMO</span>
<span class="n">difumo256</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-difumo256_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
<span class="n">difumo512</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-difumo512_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
<span class="n">difumo1024</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-difumo1024_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>

<span class="c1"># MIST</span>
<span class="n">mist197</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-mist197_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
<span class="n">mist444</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-mist444_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>

<span class="c1"># Schaefer</span>
<span class="n">schaefer</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-schaefer_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>

<span class="c1"># Smith</span>
<span class="n">smith70</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-smith_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="r2-with-fwhm-5">
<h2>R2 with <code class="docutils literal notranslate"><span class="pre">fwhm=5</span></code><a class="headerlink" href="#r2-with-fwhm-5" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dypac-intra-vs-difumo">
<h3>DYPAC intra vs DIFUMO<a class="headerlink" href="#dypac-intra-vs-difumo" title="Permalink to this headline">¶</a></h3>
<p>We first compared subject-specific DYPAC parcellations with the highest resolution (<code class="docutils literal notranslate"><span class="pre">cluster-300_state-900</span></code>) with the group parcellation which currently has state-of-the-art performance for compressing fMRI activation maps, DIFUMO <a class="bibtex reference internal" href="references.html#dadi2020-gb" id="id1">[6]</a>. DIFUMO is avaible at different resolutions (<code class="docutils literal notranslate"><span class="pre">256</span></code>, <code class="docutils literal notranslate"><span class="pre">512</span></code>, <code class="docutils literal notranslate"><span class="pre">1024</span></code>), with higher resolutions leading to higher fidelity embedding. The following graph shows the average R2 across all voxels in the cortex and all runs in the <code class="docutils literal notranslate"><span class="pre">friends-s01</span></code> validation set, for each subject. The increase in resolution for DIFUMO leads to a marked increase in R2 for all subjects, from about 0.25 to over 0.4. The individual DYPAC parcellations (<code class="docutils literal notranslate"><span class="pre">cluster-300_state-900</span></code>) systematically achieve better compression of fMRI data for all subjects, with gains of about 0.05 in R2 over DIFUMO1024, while having a smaller number of parcels (900 for DYPAC vs 1024 in DIFUMO).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">difumo256</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">difumo512</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">difumo1024</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=5&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_3_1.png" src="_images/friends-s01_r2_cortex_3_1.png" />
</div>
</div>
</div>
<div class="section" id="dypac-intra-vs-other-group-parcellations">
<h3>DYPAC intra vs other group parcellations<a class="headerlink" href="#dypac-intra-vs-other-group-parcellations" title="Permalink to this headline">¶</a></h3>
<p>We then compared DYPAC parcels (<code class="docutils literal notranslate"><span class="pre">cluster-300_state-900</span></code>) with more traditional parcellation approaches such as low-dimensional independent component analysis <a class="bibtex reference internal" href="references.html#smith2009-pt" id="id2">[17]</a>(70 parcels), the MIST multi-resolution parcellations <a class="bibtex reference internal" href="references.html#urchs2019-xc" id="id3">[19]</a> (197 and 444 parcels) as well as the Schaefer atlas <a class="bibtex reference internal" href="references.html#schaefer2018-ww" id="id4">[16]</a> (400 parcels). The expected gains in R2 with increasing resolution in group parcellation is clear for all subjects, as previously shown by <a class="bibtex reference internal" href="references.html#urchs2019-xc" id="id5">[19]</a> and others. The <code class="docutils literal notranslate"><span class="pre">state-900</span></code> DYPAC parcels showed roughly 100% improvement in R2 for all subjects, from about 0.25 for the best static group parcellations to roughly 0.5 par DYPAC.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">smith70</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">mist197</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">mist444</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">schaefer</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=5&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_5_1.png" src="_images/friends-s01_r2_cortex_5_1.png" />
</div>
</div>
</div>
<div class="section" id="dypac-multi-resolution">
<h3>DYPAC multi-resolution<a class="headerlink" href="#dypac-multi-resolution" title="Permalink to this headline">¶</a></h3>
<p>The following graph investigates the impact of the numbers <code class="docutils literal notranslate"><span class="pre">cluster</span></code> and <code class="docutils literal notranslate"><span class="pre">state</span></code> on average R2. The number of states appears to be the primary driver of R2. But even with 60 states, the R2 of individiual DYPAC parcellations is competitive with the best static group atlases (with 400+ parcels), and 120 states already outperforms them. But only the highest resolution individuals DYPAC parcellations outperform DIFUMO1024.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac60</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac120</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac150</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac300</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=5&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_7_1.png" src="_images/friends-s01_r2_cortex_7_1.png" />
</div>
</div>
</div>
<div class="section" id="intra-vs-inter-subject-r2">
<h3>Intra- vs inter-subject R2<a class="headerlink" href="#intra-vs-inter-subject-r2" title="Permalink to this headline">¶</a></h3>
<p>This last graph compares intra-subject embedding quality (parcellation and data come from the same subject) vs inter-subject embedding quality (parcellation and data come from different subject), for different numbers <code class="docutils literal notranslate"><span class="pre">cluster</span></code> and <code class="docutils literal notranslate"><span class="pre">state</span></code>. The average R2 in the cortex is systematically higher intra-subject than inter-subject. While the differenc is large between the two distributions for all parameters, the difference is reduced for higher resolution, and actually start to overlap for <code class="docutils literal notranslate"><span class="pre">cluster-300_state-900</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac60</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac120</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac150</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac300</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter60</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter120</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter150</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter300</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=5&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_9_1.png" src="_images/friends-s01_r2_cortex_9_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="r2-with-fwhm-8">
<h2>R2 with <code class="docutils literal notranslate"><span class="pre">fwhm=8</span></code><a class="headerlink" href="#r2-with-fwhm-8" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path_results</span> <span class="o">=</span> <span class="s1">&#39;/data/cisl/pbellec/cneuromod_embeddings/xp_202012/r2_friends-s01_cortex/&#39;</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># DYPAC</span>
<span class="n">dypac60</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-60.p&#39;</span><span class="p">)</span>
<span class="n">dypac120</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-120.p&#39;</span><span class="p">)</span>
<span class="n">dypac150</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-150.p&#39;</span><span class="p">)</span>
<span class="n">dypac300</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-300.p&#39;</span><span class="p">)</span>
<span class="n">dypac900</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-intra_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-300_state-900.p&#39;</span><span class="p">)</span>

<span class="c1"># DYPAC inter-subject</span>
<span class="n">inter60</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-60.p&#39;</span><span class="p">)</span>
<span class="n">inter120</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-20_state-120.p&#39;</span><span class="p">)</span>
<span class="n">inter150</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-150.p&#39;</span><span class="p">)</span>
<span class="n">inter300</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-50_state-300.p&#39;</span><span class="p">)</span>
<span class="n">inter900</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-inter_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">_cluster-300_state-900.p&#39;</span><span class="p">)</span>

<span class="c1"># DIFUMO</span>
<span class="n">difumo256</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-difumo256_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
<span class="n">difumo512</span>  <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-difumo512_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
<span class="n">difumo1024</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-difumo1024_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>

<span class="c1"># MIST</span>
<span class="n">mist197</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-mist197_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
<span class="n">mist444</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-mist444_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>

<span class="c1"># Schaefer</span>
<span class="n">schaefer</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-schaefer_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>

<span class="c1"># Smith</span>
<span class="n">smith70</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_results</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;r2_fwhm-smith_fwhm-</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">.p&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>DYPAC intra vs DIFUMO<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>When repeating the experiment with <code class="docutils literal notranslate"><span class="pre">fwhm=8</span></code> the qualitative conclusions on dypac vs difumo are identical with <code class="docutils literal notranslate"><span class="pre">fwhm=5</span></code>. But a striking difference is a huge boost in R2 (almost doubling) for both parcelation. This shows that the R2 metric is very sensitive to the level of smoothness in the data.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">difumo256</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">difumo512</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">difumo1024</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=8&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_13_1.png" src="_images/friends-s01_r2_cortex_13_1.png" />
</div>
</div>
</div>
<div class="section" id="id7">
<h3>DYPAC intra vs other group parcellations<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>The exact same observations hold for traditional parcellations: same qualitative conclusion for <code class="docutils literal notranslate"><span class="pre">fwhm=8</span></code> and <code class="docutils literal notranslate"><span class="pre">fwhm=5</span></code>, but near doubling of R2 with increased smoothing.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">smith70</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">mist197</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">mist444</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">schaefer</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=8&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_15_1.png" src="_images/friends-s01_r2_cortex_15_1.png" />
</div>
</div>
</div>
<div class="section" id="mist-multi-resolution">
<h3>MIST multi resolution<a class="headerlink" href="#mist-multi-resolution" title="Permalink to this headline">¶</a></h3>
<p>Once again with <code class="docutils literal notranslate"><span class="pre">fwhm=8</span></code> we see the number of <code class="docutils literal notranslate"><span class="pre">state</span></code> being a huge driver of R2. But we can also note that modest numbers of states (120, 150) are enough to reach high levels of R2 (0.5), while 900 states provide very high R2 (0.7). The low resolution solutions are thus an accurate summary of fluctuations at low spatial resolution. So even if the R2 of 120 and 150 states is comparatively lower with <code class="docutils literal notranslate"><span class="pre">fwhm=5</span></code> they still capture important characteristics of the data, and should be investigated in parallel to a granular and high precision solution (<code class="docutils literal notranslate"><span class="pre">cluster-300_state-900</span></code>).</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac60</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac120</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac150</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac300</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=8&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_17_1.png" src="_images/friends-s01_r2_cortex_17_1.png" />
</div>
</div>
</div>
<div class="section" id="id8">
<h3>Intra vs inter subject R2<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Same conclusion for <code class="docutils literal notranslate"><span class="pre">fwhm=8</span></code> and <code class="docutils literal notranslate"><span class="pre">fwhm=5</span></code>: intra-subject R2 is markedly superior to inter-subject R2. However the gap tightens with <code class="docutils literal notranslate"><span class="pre">fwhm=8</span></code>.</p>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_r2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac60</span><span class="p">)</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac120</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac150</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac300</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">dypac900</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter60</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter120</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter150</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter300</span><span class="p">))</span>
<span class="n">val_r2</span> <span class="o">=</span> <span class="n">val_r2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="n">inter900</span><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxenplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">val_r2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R2 embedding quality&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FWHM=</span><span class="si">{</span><span class="n">fwhm</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;FWHM=8&#39;)
</pre></div>
</div>
<img alt="_images/friends-s01_r2_cortex_19_1.png" src="_images/friends-s01_r2_cortex_19_1.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="friends-s01_reproducibility.html" title="previous page">Test-retest reproducibility</a>
    <a class='right-next' id="next-link" href="discussion.html" title="next page">Discussion</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By CNeuroMod team<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            This jupyterbook was prepared for submission at <a href="https://neurolibre.com">Neurolibre</a>.
          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>
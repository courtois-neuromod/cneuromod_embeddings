---
jupytext:
  cell_metadata_filter: -all
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.12
    jupytext_version: 1.8.0
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# Introduction  

## Main objective
Brain parcels are ubiquitous in network neuroscience, as parcels play the role of nodes in graph models of brain networks {cite}`Bullmore2009-dh`. As the fMRI field increasingly put a focus on individual-level predictions {cite}`Gratton2020-kz`, a series of recent studies have aimed to characterize individual functional parcels with long (several hours), "deep phenotyping" functional magnetic resonance (fMRI) datasets {cite}`Poldrack2021-yp`. Gordon and colleagues (2017) {cite}`Gordon2017-gd` notably showed reliable subject-specific variants in brain parcels at rest in the Midnight Brain Scan (MBS) dataset. Salehi and colleagues (2020) {cite}`Salehi2020-bh` demonstrated that fMRI brain parcels varied systematically across tasks, even for a given individual. Boukhdir and colleagues (2020) {cite}`Boukhdhir2020` then showed, again in MBS, that dynamic states of brain parcellation could be identified at rest using short sliding windows. It is not clear to what extent the task-specific parcels of Salehi and colleagues match the dynamic parcels at rest identified by Boukhdhir and colleagues. In this paper, our main objective is to assess whether dynamic parcels generalize across a variety of cognitive contexts, based on measures of reproducibility and homogeneity. We specifically investigate a collection of movie watching, resting-state, as well as a battery of controlled cognitive tasks from the Human Connectome Project (HCP) {cite}`Van_Essen2013-ph`, using the 2020 data release of the Courtois project on neuronal modelling (~40 hours of fMRI data per subject, N=6) [REF].

## Dynamic brain parcels
Traditional functional brain parcellations are "hard" assignments, i.e. each brain voxel belongs to one and only one parcel with well-defined boundaries. Hard brain parcellations in fMRI emerged in the late 90s and early 2000s, generated through cluster analysis {cite}`Goutte1999-zb,Salvador2005-cl`, and some hard functional brain parcellations are still being developed to this date, e.g. {cite}`Craddock2012-ln,Yeo2011-fd,Schaefer2018-ww`. Hard parcellations are static in nature: parcels are identical for each time point. Alternatively, many studies use "soft" parcels, where each voxel is attributed a weight of membership to a given parcel. Soft parcellations typically overlap, which makes them dynamic in nature. As each parcel is associated with a time course, the activity of a given voxel can be dominated by different overlapping parcels over time. Soft functional parcels initially became popular in the years 2000 with the application of Independent component analysis (ICA) to fMRI {cite}`Calhoun2001-kd,Damoiseaux2006-od,Smith2009-pt`, and modern variants aim to better characterize inter-individual variations and scale better to large datasets using a variety of techniques, e.g. {cite}`Harrison2020-jk,Dadi2020-gb,Du2020-tm`. Our recent work {cite}`Boukhdhir2020` draws a bridge between hard and soft parcellations. We generated hard parcels over short sliding windows with a very basic clustering algorithm (k-means), and then grouped similar parcels over time into "states", using a second (temporal) cluster analysis. Dynamic parcels were then defined as average hard parcels within each state, and the resulting soft parcels represented a probability for each brain voxel to participate in this hard parcel. We found those dynamic (soft) parcels to be highly reproducible and subject-specific.

## Reproducibility
We evaluate the quality of dynamic parcels in different cognitive contexts using reproducibility and homogeneity, following the approach of Thirion and colleagues (2014) {cite}`Thirion2014-jf`. In the context of individual fMRI analysis, reproducibility is assessed by generating parcels on two independent samples of fMRI data (called test and retest), acquired on the same subject, and compare these test-retest parcels through some quantitative reproducibility metric. For hard parcels, the most common reproducibility metric is the Dice coefficient [REF][^footnote_dice], ranging from zero (no overlap) to 1 (parcels are identical). The reproducibility of individual hard parcels was studied in MBS as a function of the duration of the test and retest dataset, and the Dice coefficient was shown to plateau at around $0.7$ with about 30 minutes of resting state data {cite}`Gordon2017-gd`. This plateau at $0.7$ is in line with the Dice observed over a wide range of clustering techniques by Arslan and colleagues {cite}`Arslan2017-tz` in the HCP sample {cite}`Van_Essen2013-ph`. Soft parcellations are more challenging to compare, as there is no one-to-one voxel-to-parcel correspondence, and it was proposed to match parcels between the test and retest dataset before quantifying the similarity of parcels with a spatial correlation coefficient, see e.g. {cite}`Zuo2010-vn`. Survey reproducibility indices for ICA at the individual level...

## Homogeneity
An important difference between static and dynamic parcellations was how fMRI data were compressed in parcels. In the case of a static parcellation, the compression was univariate. Each parcel represented the average functional activity at a specific spatial location in the cerebral cortex. An average signal was generated for each parcel, or a principal component analysis was applied to the signal inside the parcel [Eickhoff et al., 2018]. In the case of dynamic parcellations, the compression was multivariate as the parcels (or spatial modes of decomposition) were used altogether using a multivariate regression analysis to fit a full brain activity volumes over time {cite}`Calhoun2001-kd` resulting in spatially overlapping parcels, i.e., the same voxel was involved with different states. Recently, some researchers showed the application of a dynamic approach improved the fidelity of the compressed data to the actual neurobiological changes over time in space. For instance, Dadi and colleagues used the spatial sparsity constraint to generate dynamic brain parcels [Dadi et al. 2020]. Authors showed the compression of activation maps was improved using soft and dynamic parcellations over a range of classic static parcellations [Dadi et al. 2020]. Here, authors showed the existence of variability in temporal features that were not confounded with spatial features [Harrison et al,  2020]. Even though there existed several static functional approaches in the literature, there was no consensus on which approach better reduce the high dimensionality of the functional data [Cite surveys Arslan et al. 2017]. That is, the compression rate of static parcellations seem to reflect primarily the size of parcels (resolution), and state-of-the-art algorithms offer little to no advantage compared to random brain parcellation (see Fig 7 of Urchs et al. 2019).

## Generalization across cognitive contexts

## Specific objectives
In this paper, we build upon the findings of Boukhdhir and colleagues and we extend the dynamic parcellation approach to extract full brain dynamic states of functional parcellations at the individual level [Boukhdhir et al. 2020]. We define a dynamic state of parcellation as the time-space decomposition that occurs for short time durations in the resting state condition. This approach is based on aggregating sliding-window parcellations for a given region to obtain stability maps of the different dynamic states of parcellations. We generate these dynamic states for the six subjects of the Courtois Neuromod dataset and we aim to evaluate the compression quality of the state stability maps at the full brain level. We also aim to study similarities and variations within-subject (between sets of independent data for the same subject) and across subjects.   

[^footnote_dice]: Let $v$ be a voxel, and $T_v, R_v$ be the parcels containing $v$ for the test and retest respectively. The Dice coefficient $D_v$ is the size of the intersection between $T_v$ and $R_v$ relative to the average size of the two parcels, or $2\times |T_v \cap R_z|/(|T_z| + |R(v)|)$. The local Dice $D_v$ can be further averaged across all voxels $v$ to provide a global parcellation reproducibility score.
